# 接口的幂等性

接口调用存在的问题：
1.返回超时：
Service A调用Service B时，可能出现区域间通信失败的情况(P)，如果Service B接收并且处理成功只是返回超时失败，那么服务提供方就必须允许客户端发起重试操作，所以B会收到很多相同的请求，所以需要额外处理，因此出现了幂等性的概念。
2.用户重复点击：
重复的请求内容会发到服务器

接口的幂等性是指多次相同的请求返回的结果是相同的。

什么情况下需要保持接口的幂等性，可以从增删改查四种操作来分析：
增：可以依靠数据库来保证，传入唯一索引，如果重复，可以DB判断出来
删：根据唯一条件进行删除，返回的影响行数不同，第一次是1行，第二次就是0行，所以需要额外注意
改：分为两种情况
查：天然的幂等性


解决方案：

如何保证接口的幂等性
https://segmentfault.com/a/1190000020172463

token机制
乐观锁机制
唯一索引
幂等需要通过唯一的业务单号来保证

对外提供接口的api如何保证幂等：
需要传入流水号，流水号作为唯一索引存在于数据库中。

